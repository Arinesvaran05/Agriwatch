import{a as I}from"./chunk-MJYXO2CU.js";import{$ as i,B as _,Ba as E,Ca as H,D as y,Ea as L,Fa as T,H as f,O as p,P as t,Q as e,S as C,T as c,U as h,Y as M,Z as v,aa as w,ba as g,ha as x,ia as b,ja as O,p as m,q as s,qa as S,ra as k,sa as P,ta as D,y as l}from"./chunk-WZYVPUJW.js";function V(d,o){if(d&1&&(t(0,"div",44),i(1),e()),d&2){let r=h();l(),g(" ",r.currentHumidity.value,"% ")}}function R(d,o){d&1&&(t(0,"div",45),i(1,"Loading..."),e())}function z(d,o){if(d&1&&(t(0,"p",46),i(1),x(2,"date"),e()),d&2){let r=h();l(),g(" Last updated: ",b(2,1,r.currentHumidity.timestamp,"medium")," ")}}function U(d,o){d&1&&(t(0,"span"),i(1,"\u{1F504} Refresh"),e())}function F(d,o){d&1&&(t(0,"span"),i(1,"\u23F3 Refreshing..."),e())}function j(d,o){if(d&1&&(t(0,"div",47),i(1),x(2,"date"),e()),d&2){let r=h();l(),g(" Last updated: ",b(2,1,r.lastRefreshTime,"short")," ")}}function B(d,o){if(d&1&&(t(0,"tr")(1,"td",35),i(2),x(3,"date"),e(),t(4,"td",35),i(5),e(),t(6,"td",35)(7,"span",48),i(8),e()()()),d&2){let r=o.$implicit,n=h();v("high",r.value>80)("low",r.value<30),l(2),w(b(3,11,r.timestamp,"medium")),l(3),g("",r.value,"%"),l(2),v("normal",r.value>=30&&r.value<=80)("warning",r.value>80||r.value<30),l(),g(" ",n.getStatus(r.value)," ")}}var A=class d{constructor(o,r,n){this.authService=o;this.dataService=r;this.router=n;this.currentUser=this.authService.currentUserValue}currentUser;currentHumidity=null;humidityLog=[];selectedLimit=50;isRefreshing=!1;lastRefreshTime=null;refreshInterval;ngOnInit(){this.loadCurrentHumidity(),this.loadHumidityLog(this.selectedLimit),this.refreshInterval=setInterval(()=>{this.refreshData()},1e4)}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval)}loadCurrentHumidity(){this.dataService.getCurrentHumidity().subscribe({next:o=>this.currentHumidity=o,error:o=>console.error("Error loading humidity data:",o)})}loadHumidityLog(o){this.selectedLimit=Math.min(Math.max(o,50),200),this.dataService.getHumidityLog(this.selectedLimit).subscribe({next:r=>this.humidityLog=r,error:r=>console.error("Error loading humidity log:",r)})}refreshData(){this.isRefreshing=!0,this.loadCurrentHumidity(),this.loadHumidityLog(this.selectedLimit),this.lastRefreshTime=new Date,setTimeout(()=>{this.isRefreshing=!1},1e3)}manualRefresh(){this.refreshData()}downloadData(o=100){this.dataService.downloadHumidityLog(o).subscribe({next:r=>{let n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download=`admin_humidity_log_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)},error:r=>console.error("Error downloading data:",r)})}getStatus(o){return o>=30&&o<=80?"Normal":o>80?"High":"Low"}getAverageHumidity(){if(this.humidityLog.length===0)return 0;let o=this.humidityLog.reduce((r,n)=>r+n.value,0);return Math.round(o/this.humidityLog.length*100)/100}getMaxHumidity(){return this.humidityLog.length===0?0:Math.max(...this.humidityLog.map(o=>o.value))}getMinHumidity(){return this.humidityLog.length===0?0:Math.min(...this.humidityLog.map(o=>o.value))}getHumidityRange(){return Math.round((this.getMaxHumidity()-this.getMinHumidity())*100)/100}goBack(){this.router.navigate(["/admin/dashboard"])}goToDashboard(){this.router.navigate(["/admin/dashboard"])}goToTemperature(){this.router.navigate(["/admin/temperature"])}goToSoilMoisture(){this.router.navigate(["/admin/soil-moisture"])}goToUsers(){this.router.navigate(["/admin/users"])}goToProfile(){this.router.navigate(["/admin/profile"])}goToDataVisualization(){this.router.navigate(["/admin/data-visualization"])}logout(){this.authService.logout(),this.router.navigate(["/login"])}static \u0275fac=function(r){return new(r||d)(_(T),_(I),_(E))};static \u0275cmp=y({type:d,selectors:[["app-admin-humidity"]],decls:115,vars:13,consts:[["humLoading",""],[1,"admin-humidity-container"],[1,"admin-humidity-header"],[1,"header-content"],[1,"header-left"],[1,"back-btn",3,"click"],[1,"user-info"],[1,"logout-btn",3,"click"],[1,"admin-humidity-nav"],["routerLink","/admin/dashboard",1,"nav-item"],["routerLink","/admin/temperature",1,"nav-item"],["routerLink","/admin/humidity",1,"nav-item","active"],["routerLink","/admin/soil-moisture",1,"nav-item"],["routerLink","/admin/users",1,"nav-item"],["routerLink","/admin/data-visualization",1,"nav-item"],["routerLink","/admin/profile",1,"nav-item"],[1,"admin-humidity-main"],[1,"current-reading"],[1,"reading-card"],[1,"reading-icon"],[1,"reading-content"],["class","reading-value",4,"ngIf","ngIfElse"],["class","reading-time",4,"ngIf"],[1,"historical-data"],[1,"section-header"],[1,"refresh-controls"],[1,"refresh-btn",3,"click","disabled"],[4,"ngIf"],["class","last-refresh",4,"ngIf"],[1,"data-controls"],[1,"control-btn",3,"click"],[1,"download-group"],[1,"download-btn",3,"click"],[1,"data-table"],[2,"text-align","center"],[2,"text-align","center !important"],[3,"high","low",4,"ngFor","ngForOf"],[1,"statistics"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-value"],[1,"quick-actions"],[1,"action-buttons"],[1,"action-btn",3,"click"],[1,"reading-value"],[1,"loading"],[1,"reading-time"],[1,"last-refresh"],[1,"status"]],template:function(r,n){if(r&1){let a=C();t(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4)(4,"button",5),c("click",function(){return m(a),s(n.goBack())}),i(5,"\u2190 Back"),e(),t(6,"h1"),i(7,"\u{1F4A7} Admin Humidity Monitoring"),e()(),t(8,"div",6)(9,"span"),i(10),e(),t(11,"button",7),c("click",function(){return m(a),s(n.logout())}),i(12,"Sign Out"),e()()()(),t(13,"nav",8)(14,"a",9),i(15,"Dashboard"),e(),t(16,"a",10),i(17,"Temperature"),e(),t(18,"a",11),i(19,"Humidity"),e(),t(20,"a",12),i(21,"Soil Moisture"),e(),t(22,"a",13),i(23,"Users"),e(),t(24,"a",14),i(25,"Data Visualization"),e(),t(26,"a",15),i(27,"Profile"),e()(),t(28,"main",16)(29,"section",17)(30,"h2"),i(31,"Current Humidity"),e(),t(32,"div",18)(33,"div",19),i(34,"\u{1F4A7}"),e(),t(35,"div",20),f(36,V,2,1,"div",21)(37,R,2,0,"ng-template",null,0,O)(39,z,3,4,"p",22),e()()(),t(40,"section",23)(41,"div",24)(42,"h2"),i(43,"Humidity History"),e(),t(44,"div",25)(45,"button",26),c("click",function(){return m(a),s(n.manualRefresh())}),f(46,U,2,0,"span",27)(47,F,2,0,"span",27),e(),f(48,j,3,4,"div",28),e()(),t(49,"div",29)(50,"button",30),c("click",function(){return m(a),s(n.loadHumidityLog(50))}),i(51,"Last 50"),e(),t(52,"button",30),c("click",function(){return m(a),s(n.loadHumidityLog(100))}),i(53,"Last 100"),e(),t(54,"button",30),c("click",function(){return m(a),s(n.loadHumidityLog(200))}),i(55,"Last 200"),e(),t(56,"div",31)(57,"button",32),c("click",function(){return m(a),s(n.downloadData(50))}),i(58,"\u{1F4E5} Download 50"),e(),t(59,"button",32),c("click",function(){return m(a),s(n.downloadData(100))}),i(60,"\u{1F4E5} Download 100"),e(),t(61,"button",32),c("click",function(){return m(a),s(n.downloadData(200))}),i(62,"\u{1F4E5} Download 200"),e()()(),t(63,"div",33)(64,"table",34)(65,"thead")(66,"tr")(67,"th",35),i(68,"Timestamp"),e(),t(69,"th",35),i(70,"Humidity (%)"),e(),t(71,"th",35),i(72,"Status"),e()()(),t(73,"tbody"),f(74,B,9,14,"tr",36),e()()()(),t(75,"section",37)(76,"h2"),i(77,"Humidity Statistics"),e(),t(78,"div",38)(79,"div",39)(80,"h3"),i(81,"Average"),e(),t(82,"div",40),i(83),e()(),t(84,"div",39)(85,"h3"),i(86,"Maximum"),e(),t(87,"div",40),i(88),e()(),t(89,"div",39)(90,"h3"),i(91,"Minimum"),e(),t(92,"div",40),i(93),e()(),t(94,"div",39)(95,"h3"),i(96,"Range"),e(),t(97,"div",40),i(98),e()()()(),t(99,"section",41)(100,"h2"),i(101,"Quick Actions"),e(),t(102,"div",42)(103,"button",43),c("click",function(){return m(a),s(n.goToDashboard())}),i(104,"\u{1F3E0} Dashboard"),e(),t(105,"button",43),c("click",function(){return m(a),s(n.goToTemperature())}),i(106,"\u{1F321}\uFE0F Temperature"),e(),t(107,"button",43),c("click",function(){return m(a),s(n.goToSoilMoisture())}),i(108,"\u{1F331} Soil Moisture"),e(),t(109,"button",43),c("click",function(){return m(a),s(n.goToUsers())}),i(110,"\u{1F465} Manage Users"),e(),t(111,"button",43),c("click",function(){return m(a),s(n.goToDataVisualization())}),i(112,"\u{1F4CA} Data Visualization"),e(),t(113,"button",43),c("click",function(){return m(a),s(n.goToProfile())}),i(114,"\u{1F464} Profile"),e()()()()()}if(r&2){let a=M(38);l(10),g("Welcome, ",n.currentUser==null?null:n.currentUser.name),l(26),p("ngIf",n.currentHumidity)("ngIfElse",a),l(3),p("ngIf",n.currentHumidity),l(6),p("disabled",n.isRefreshing),l(),p("ngIf",!n.isRefreshing),l(),p("ngIf",n.isRefreshing),l(),p("ngIf",n.lastRefreshTime),l(26),p("ngForOf",n.humidityLog),l(9),g("",n.getAverageHumidity(),"%"),l(5),g("",n.getMaxHumidity(),"%"),l(5),g("",n.getMinHumidity(),"%"),l(5),g("",n.getHumidityRange(),"%")}},dependencies:[D,S,k,L,H,P],styles:[".admin-humidity-container[_ngcontent-%COMP%]{min-height:calc(100vh - 200px);background:#f8f9fa;padding-bottom:20px}.admin-humidity-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#17a2b8,#20c997);color:#fff;padding:20px 0;box-shadow:0 2px 10px #0000001a}.header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.back-btn[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:8px 16px;border-radius:8px;cursor:pointer;transition:background .3s ease;font-size:1rem}.back-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.logout-btn[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:8px 16px;border-radius:8px;cursor:pointer;transition:background .3s ease}.logout-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.admin-humidity-nav[_ngcontent-%COMP%]{background:#fff;padding:0 40px;border-bottom:1px solid #e1e8ed}.nav-item[_ngcontent-%COMP%]{display:inline-block;padding:15px 20px;color:#7f8c8d;text-decoration:none;border-bottom:3px solid transparent;transition:all .3s ease}.nav-item[_ngcontent-%COMP%]:hover, .nav-item.active[_ngcontent-%COMP%]{color:#17a2b8;border-bottom-color:#17a2b8}.admin-humidity-main[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:30px 20px}.current-reading[_ngcontent-%COMP%], .historical-data[_ngcontent-%COMP%], .statistics[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%]{margin-bottom:40px}.current-reading[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .historical-data[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .statistics[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:20px;font-size:1.5rem}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:15px}.refresh-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.refresh-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;transition:all .3s ease;font-weight:500;font-size:.9rem}.refresh-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 8px #28a7454d}.refresh-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed;transform:none}.last-refresh[_ngcontent-%COMP%]{color:#6c757d;font-size:.85rem;font-style:italic}.reading-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:30px;box-shadow:0 5px 15px #00000014;display:flex;align-items:center;gap:30px}.reading-icon[_ngcontent-%COMP%]{font-size:3rem}.reading-value[_ngcontent-%COMP%]{font-size:3rem;font-weight:700;color:#17a2b8;margin-bottom:10px}.reading-time[_ngcontent-%COMP%]{color:#7f8c8d;margin:0}.loading[_ngcontent-%COMP%]{color:#7f8c8d;font-style:italic}.data-controls[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;gap:10px;flex-wrap:wrap}.control-btn[_ngcontent-%COMP%], .download-btn[_ngcontent-%COMP%]{padding:10px 20px;border:2px solid #667eea;background:#fff;color:#667eea;border-radius:8px;cursor:pointer;transition:all .3s ease;font-weight:500}.control-btn[_ngcontent-%COMP%]:hover, .download-btn[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff}.data-table[_ngcontent-%COMP%]{background:#fff;border-radius:15px;overflow:hidden;box-shadow:0 5px 15px #00000014}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:15px;text-align:left;border-bottom:1px solid #e1e8ed}th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600;color:#2c3e50}tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:.9rem;font-weight:500}.status.normal[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status.warning[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:25px;box-shadow:0 5px 15px #00000014;text-align:center}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#7f8c8d;margin:0 0 15px;font-size:1rem}.stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#667eea}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:15px;flex-wrap:wrap}.action-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;transition:transform .3s ease;font-weight:500;font-size:1rem}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}.header-left[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.reading-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.data-controls[_ngcontent-%COMP%]{justify-content:center}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.action-buttons[_ngcontent-%COMP%]{justify-content:center}}"]})};export{A as AdminHumidityComponent};
