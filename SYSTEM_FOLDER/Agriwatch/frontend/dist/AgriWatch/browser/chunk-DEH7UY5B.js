import{a as V,b as g,c as D,d as N,f as L,g as G,h as z,l as A,m as q,o as B}from"./chunk-OX5MQXUP.js";import{$ as s,B as C,Ba as I,Ca as R,D as y,Ea as k,Fa as T,H as p,N as P,O as c,P as t,Q as n,R as x,S as b,T as _,U as m,Z as v,aa as S,ba as M,p as u,q as f,ra as E,ta as O,y as i}from"./chunk-WZYVPUJW.js";function H(e,r){e&1&&(t(0,"div",19),s(1," Please enter a valid email address "),n())}function Y(e,r){e&1&&(t(0,"span"),s(1,"Send Reset Code"),n())}function W(e,r){e&1&&(t(0,"span"),s(1,"Sending..."),n())}function $(e,r){if(e&1){let o=b();t(0,"div",10)(1,"p",11),s(2," Enter your email address and we'll send you a 4-digit code to reset your password. "),n(),t(3,"form",12),_("ngSubmit",function(){u(o);let a=m();return f(a.onSubmit())}),t(4,"div",13)(5,"label",14),s(6,"Email Address"),n(),x(7,"input",15),p(8,H,2,0,"div",16),n(),t(9,"button",17),p(10,Y,2,0,"span",18)(11,W,2,0,"span",18),n()()()}if(e&2){let o,l,a=m();i(3),c("formGroup",a.forgotForm),i(4),v("error",((o=a.forgotForm.get("email"))==null?null:o.invalid)&&((o=a.forgotForm.get("email"))==null?null:o.touched)),i(),c("ngIf",((l=a.forgotForm.get("email"))==null?null:l.invalid)&&((l=a.forgotForm.get("email"))==null?null:l.touched)),i(),c("disabled",a.forgotForm.invalid||a.isLoading),i(),c("ngIf",!a.isLoading),i(),c("ngIf",a.isLoading)}}function J(e,r){e&1&&(t(0,"div",19),s(1," Please enter a valid 4-digit code "),n())}function K(e,r){e&1&&(t(0,"span",35),s(1,"\u{1F441}"),n())}function Q(e,r){e&1&&(t(0,"span",36),s(1,"\u{1F6AB}"),n())}function U(e,r){e&1&&(t(0,"div",19),s(1," Password must be at least 6 characters long "),n())}function X(e,r){e&1&&(t(0,"span",35),s(1,"\u{1F441}"),n())}function Z(e,r){e&1&&(t(0,"span",36),s(1,"\u{1F6AB}"),n())}function ee(e,r){e&1&&(t(0,"span"),s(1,"Confirm password is required"),n())}function te(e,r){e&1&&(t(0,"span"),s(1,"Passwords do not match"),n())}function ne(e,r){if(e&1&&(t(0,"div",19),p(1,ee,2,0,"span",18)(2,te,2,0,"span",18),n()),e&2){let o,l,a=m(2);i(),c("ngIf",(o=a.resetForm.get("confirm_password"))==null?null:o.hasError("required")),i(),c("ngIf",!((l=a.resetForm.get("confirm_password"))!=null&&l.hasError("required"))&&a.resetForm.hasError("passwordMismatch"))}}function oe(e,r){e&1&&(t(0,"span"),s(1,"Reset Password"),n())}function re(e,r){e&1&&(t(0,"span"),s(1,"Resetting..."),n())}function ie(e,r){e&1&&(t(0,"span"),s(1,"Resend Code"),n())}function se(e,r){e&1&&(t(0,"span"),s(1,"Sending..."),n())}function ae(e,r){if(e&1){let o=b();t(0,"div",20)(1,"p",11),s(2," We've sent a 4-digit reset code to "),t(3,"strong"),s(4),n()(),t(5,"form",21),_("ngSubmit",function(){u(o);let a=m();return f(a.onResetSubmit())}),t(6,"div",13)(7,"label",22),s(8,"Reset Code"),n(),x(9,"input",23),p(10,J,2,0,"div",16),n(),t(11,"div",13)(12,"label",24),s(13,"New Password"),n(),t(14,"div",25),x(15,"input",26),t(16,"button",27),_("click",function(){u(o);let a=m();return f(a.toggleNewPasswordVisibility())}),p(17,K,2,0,"span",28)(18,Q,2,0,"span",29),n()(),p(19,U,2,0,"div",16),n(),t(20,"div",13)(21,"label",30),s(22,"Confirm Password"),n(),t(23,"div",25),x(24,"input",31),t(25,"button",27),_("click",function(){u(o);let a=m();return f(a.toggleConfirmPasswordVisibility())}),p(26,X,2,0,"span",28)(27,Z,2,0,"span",29),n()(),p(28,ne,3,2,"div",16),n(),t(29,"button",32),p(30,oe,2,0,"span",18)(31,re,2,0,"span",18),n()(),t(32,"div",33)(33,"p"),s(34,"Didn't receive the code?"),n(),t(35,"button",34),_("click",function(){u(o);let a=m();return f(a.resendCode())}),p(36,ie,2,0,"span",18)(37,se,2,0,"span",18),n()()()}if(e&2){let o,l,a,h,w,F,d=m();i(4),S(d.userEmail),i(),c("formGroup",d.resetForm),i(4),v("error",((o=d.resetForm.get("reset_code"))==null?null:o.invalid)&&((o=d.resetForm.get("reset_code"))==null?null:o.touched)),i(),c("ngIf",((l=d.resetForm.get("reset_code"))==null?null:l.invalid)&&((l=d.resetForm.get("reset_code"))==null?null:l.touched)),i(5),v("error",((a=d.resetForm.get("new_password"))==null?null:a.invalid)&&((a=d.resetForm.get("new_password"))==null?null:a.touched)),c("type",d.showNewPassword?"text":"password"),i(),P("aria-label",d.showNewPassword?"Hide new password":"Show new password"),i(),c("ngIf",!d.showNewPassword),i(),c("ngIf",d.showNewPassword),i(),c("ngIf",((h=d.resetForm.get("new_password"))==null?null:h.invalid)&&((h=d.resetForm.get("new_password"))==null?null:h.touched)),i(5),v("error",((w=d.resetForm.get("confirm_password"))==null?null:w.invalid)&&((w=d.resetForm.get("confirm_password"))==null?null:w.touched)||d.resetForm.hasError("passwordMismatch")&&((w=d.resetForm.get("confirm_password"))==null?null:w.touched)),c("type",d.showConfirmPassword?"text":"password"),i(),P("aria-label",d.showConfirmPassword?"Hide confirm password":"Show confirm password"),i(),c("ngIf",!d.showConfirmPassword),i(),c("ngIf",d.showConfirmPassword),i(),c("ngIf",(F=d.resetForm.get("confirm_password"))==null?null:F.touched),i(),c("disabled",d.resetForm.invalid||d.isResetting),i(),c("ngIf",!d.isResetting),i(),c("ngIf",d.isResetting),i(4),c("disabled",d.isResending),i(),c("ngIf",!d.isResending),i(),c("ngIf",d.isResending)}}function de(e,r){if(e&1){let o=b();t(0,"div",37)(1,"div",38),s(2,"\u2705"),n(),t(3,"h2"),s(4,"Password Reset Successfully!"),n(),t(5,"p"),s(6,"Your password has been reset. You can now log in with your new password."),n(),t(7,"button",39),_("click",function(){u(o);let a=m();return f(a.goToLogin())}),s(8,"Go to Login"),n()()}}function le(e,r){if(e&1&&(t(0,"div",40),s(1),n()),e&2){let o=m();i(),M(" ",o.errorMessage," ")}}function ce(e,r){if(e&1&&(t(0,"div",41),s(1),n()),e&2){let o=m();i(),M(" ",o.successMessage," ")}}var j=class e{constructor(r,o,l){this.fb=r;this.authService=o;this.router=l;this.forgotForm=this.fb.group({email:["",[g.required,g.email]]}),this.resetForm=this.fb.group({reset_code:["",[g.required,g.pattern(/^\d{4}$/)]],new_password:["",[g.required,g.minLength(6)]],confirm_password:["",[g.required]]},{validators:this.passwordMatchValidator})}forgotForm;resetForm;isLoading=!1;isResetting=!1;isResending=!1;isResetCodeSent=!1;isPasswordReset=!1;errorMessage="";successMessage="";userEmail="";showNewPassword=!1;showConfirmPassword=!1;passwordMatchValidator(r){let o=r.get("new_password")?.value,l=r.get("confirm_password")?.value;return!o||!l||o===l?null:{passwordMismatch:!0}}toggleNewPasswordVisibility(){this.showNewPassword=!this.showNewPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){this.forgotForm.valid&&(this.isLoading=!0,this.errorMessage="",this.successMessage="",this.authService.forgotPassword(this.forgotForm.value).subscribe({next:r=>{this.isLoading=!1,this.isResetCodeSent=!0,this.userEmail=this.forgotForm.value.email,this.successMessage=r.message||"Reset code sent successfully!"},error:r=>{this.isLoading=!1,this.errorMessage=r.error?.message||"Failed to send reset code. Please try again."}}))}onResetSubmit(){if(this.resetForm.valid){this.isResetting=!0,this.errorMessage="",this.successMessage="";let r={email:this.userEmail,reset_code:this.resetForm.value.reset_code,new_password:this.resetForm.value.new_password};this.authService.resetPassword(r).subscribe({next:o=>{this.isResetting=!1,this.isPasswordReset=!0,this.successMessage=o.message||"Password reset successfully!"},error:o=>{this.isResetting=!1,this.errorMessage=o.error?.message||"Failed to reset password. Please try again."}})}}resendCode(){this.isResending=!0,this.errorMessage="",this.successMessage="",this.authService.forgotPassword({email:this.userEmail}).subscribe({next:r=>{this.isResending=!1,this.successMessage=r.message||"New reset code sent!"},error:r=>{this.isResending=!1,this.errorMessage=r.error?.message||"Failed to resend code. Please try again."}})}goToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(o){return new(o||e)(C(q),C(T),C(I))};static \u0275cmp=y({type:e,selectors:[["app-forgot-password"]],decls:17,vars:5,consts:[[1,"forgot-container"],[1,"forgot-card"],[1,"forgot-header"],["class","forgot-content",4,"ngIf"],["class","reset-content",4,"ngIf"],["class","success-content",4,"ngIf"],[1,"forgot-footer"],["routerLink","/login",1,"login-link"],["class","error-alert",4,"ngIf"],["class","success-alert",4,"ngIf"],[1,"forgot-content"],[1,"instruction"],[1,"forgot-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Enter your email"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-btn",3,"disabled"],[4,"ngIf"],[1,"error-message"],[1,"reset-content"],[1,"reset-form",3,"ngSubmit","formGroup"],["for","resetCode"],["type","text","id","resetCode","formControlName","reset_code","placeholder","Enter 4-digit code","maxlength","4"],["for","newPassword"],[1,"password-input-container"],["id","newPassword","formControlName","new_password","placeholder","Enter new password",3,"type"],["type","button",1,"password-toggle",3,"click"],["class","eye-icon",4,"ngIf"],["class","eye-slash-icon",4,"ngIf"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirm_password","placeholder","Confirm new password",3,"type"],["type","submit",1,"reset-btn",3,"disabled"],[1,"resend-section"],[1,"resend-btn",3,"click","disabled"],[1,"eye-icon"],[1,"eye-slash-icon"],[1,"success-content"],[1,"success-icon"],[1,"login-btn",3,"click"],[1,"error-alert"],[1,"success-alert"]],template:function(o,l){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),s(4,"\u{1F331} AgriWatch"),n(),t(5,"p"),s(6,"Reset your password"),n()(),p(7,$,12,7,"div",3)(8,ae,38,25,"div",4)(9,de,9,0,"div",5),t(10,"div",6)(11,"p"),s(12,"Remember your password? "),t(13,"a",7),s(14,"Sign In"),n()()(),p(15,le,2,1,"div",8)(16,ce,2,1,"div",9),n()()),o&2&&(i(7),c("ngIf",!l.isResetCodeSent),i(),c("ngIf",l.isResetCodeSent&&!l.isPasswordReset),i(),c("ngIf",l.isPasswordReset),i(6),c("ngIf",l.errorMessage),i(),c("ngIf",l.successMessage))},dependencies:[O,E,B,L,V,D,N,A,G,z,k,R],styles:[".forgot-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:url(https://images.unsplash.com/photo-1500937386664-56d1dfef3854?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80);background-size:cover;background-position:center;background-attachment:fixed;padding:20px}.forgot-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;box-shadow:0 20px 40px #0000001a;padding:40px;width:100%;max-width:450px}.forgot-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.forgot-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px;font-size:2.5rem}.forgot-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin:0}.forgot-content[_ngcontent-%COMP%], .reset-content[_ngcontent-%COMP%]{margin-bottom:20px}.instruction[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:25px;line-height:1.5}.forgot-form[_ngcontent-%COMP%], .reset-form[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#2c3e50;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e1e8ed;border-radius:10px;font-size:16px;transition:border-color .3s ease;box-sizing:border-box}.password-input-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:50px}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:8px;background:#f5f5f5;border:1px solid #ccc;cursor:pointer;font-size:14px;padding:4px 6px;border-radius:3px;transition:none;display:flex;align-items:center;justify-content:center;width:28px;height:28px;color:#333;font-family:monospace}.password-toggle[_ngcontent-%COMP%]:hover{background-color:#e9e9e9;border-color:#999}.password-toggle[_ngcontent-%COMP%]:focus{outline:1px solid #666;outline-offset:1px}.password-toggle[_ngcontent-%COMP%]:active{background-color:#ddd}.eye-icon[_ngcontent-%COMP%], .eye-slash-icon[_ngcontent-%COMP%]{font-size:12px;line-height:1}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:#e74c3c}.form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{text-align:center;letter-spacing:4px;font-size:18px}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:14px;margin-top:5px}.submit-btn[_ngcontent-%COMP%], .reset-btn[_ngcontent-%COMP%]{width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s ease}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled), .reset-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px)}.submit-btn[_ngcontent-%COMP%]:disabled, .reset-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.resend-section[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid #e1e8ed}.resend-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:10px}.resend-btn[_ngcontent-%COMP%]{background:none;border:2px solid #667eea;color:#667eea;padding:8px 20px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease}.resend-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#667eea;color:#fff}.resend-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.success-content[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.success-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:20px}.success-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#27ae60;margin-bottom:15px}.success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:25px}.login-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#27ae60,#2ecc71);color:#fff;border:none;padding:12px 30px;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s ease}.login-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.forgot-footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.login-link[_ngcontent-%COMP%]{color:#667eea;text-decoration:none;font-weight:600}.login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-alert[_ngcontent-%COMP%]{background:#fee;color:#e74c3c;padding:12px;border-radius:8px;margin-top:20px;text-align:center;border:1px solid #fcc}.success-alert[_ngcontent-%COMP%]{background:#efe;color:#27ae60;padding:12px;border-radius:8px;margin-top:20px;text-align:center;border:1px solid #cfc}"]})};export{j as ForgotPasswordComponent};
