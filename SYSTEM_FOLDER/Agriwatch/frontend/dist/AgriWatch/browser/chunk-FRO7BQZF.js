import{a as I,b as _,c as k,d as F,f as R,g as T,h as D,l as L,m as A,o as N}from"./chunk-OX5MQXUP.js";import{$ as o,B as f,Ba as O,Ca as V,D as b,Ea as S,Fa as w,H as m,O as d,P as i,Q as n,R as y,S as v,T as u,U as l,Z as C,aa as h,ba as x,p,q as g,ra as M,ta as E,y as a,za as P}from"./chunk-WZYVPUJW.js";function j(t,s){t&1&&(i(0,"div",20),o(1," Please enter a valid 4-digit code "),n())}function B(t,s){t&1&&(i(0,"span"),o(1,"Verify Email"),n())}function Y(t,s){t&1&&(i(0,"span"),o(1,"Verifying..."),n())}function q(t,s){t&1&&(i(0,"span"),o(1,"Resend Code"),n())}function H(t,s){t&1&&(i(0,"span"),o(1,"Sending..."),n())}function W(t,s){if(t&1){let e=v();i(0,"div",9)(1,"p",10),o(2," We've sent a 4-digit verification code to "),i(3,"strong"),o(4),n()(),i(5,"form",11),u("ngSubmit",function(){p(e);let r=l();return g(r.onSubmit())}),i(6,"div",12)(7,"label",13),o(8,"Verification Code"),n(),y(9,"input",14),m(10,j,2,0,"div",15),n(),i(11,"button",16),m(12,B,2,0,"span",17)(13,Y,2,0,"span",17),n()(),i(14,"div",18)(15,"p"),o(16,"Didn't receive the code?"),n(),i(17,"button",19),u("click",function(){p(e);let r=l();return g(r.resendCode())}),m(18,q,2,0,"span",17)(19,H,2,0,"span",17),n()()()}if(t&2){let e,c,r=l();a(4),h(r.userEmail),a(),d("formGroup",r.verifyForm),a(4),C("error",((e=r.verifyForm.get("verification_code"))==null?null:e.invalid)&&((e=r.verifyForm.get("verification_code"))==null?null:e.touched)),a(),d("ngIf",((c=r.verifyForm.get("verification_code"))==null?null:c.invalid)&&((c=r.verifyForm.get("verification_code"))==null?null:c.touched)),a(),d("disabled",r.verifyForm.invalid||r.isLoading),a(),d("ngIf",!r.isLoading),a(),d("ngIf",r.isLoading),a(4),d("disabled",r.isResending),a(),d("ngIf",!r.isResending),a(),d("ngIf",r.isResending)}}function $(t,s){if(t&1){let e=v();i(0,"div",21)(1,"div",22),o(2,"\u2705"),n(),i(3,"h2"),o(4,"Email Verified Successfully!"),n(),i(5,"p"),o(6,"Your email has been verified. You can now log in to your account."),n(),i(7,"button",23),u("click",function(){p(e);let r=l();return g(r.goToLogin())}),o(8,"Go to Login"),n()()}}function J(t,s){if(t&1&&(i(0,"div",24),o(1),n()),t&2){let e=l();a(),x(" ",e.errorMessage," ")}}function K(t,s){if(t&1&&(i(0,"div",25),o(1),n()),t&2){let e=l();a(),x(" ",e.successMessage," ")}}var G=class t{constructor(s,e,c,r){this.fb=s;this.authService=e;this.router=c;this.route=r;this.verifyForm=this.fb.group({verification_code:["",[_.required,_.pattern(/^\d{4}$/)]]}),this.route.queryParams.subscribe(z=>{this.userEmail=z.email||""}),this.userEmail||(this.userEmail="your email address")}verifyForm;isLoading=!1;isResending=!1;isVerified=!1;errorMessage="";successMessage="";userEmail="";onSubmit(){if(this.verifyForm.valid){this.isLoading=!0,this.errorMessage="",this.successMessage="";let s={email:this.userEmail,verification_code:this.verifyForm.value.verification_code};this.authService.verifyEmail(s).subscribe({next:e=>{this.isLoading=!1,this.isVerified=!0,this.successMessage=e.message||"Email verified successfully!"},error:e=>{this.isLoading=!1,this.errorMessage=e.error?.message||"Verification failed. Please try again."}})}}resendCode(){this.isResending=!0,this.errorMessage="",this.successMessage="";let s={email:this.userEmail};this.authService.resendVerification(s).subscribe({next:e=>{this.isResending=!1,this.successMessage=e.message||"New verification code sent!"},error:e=>{this.isResending=!1,this.errorMessage=e.error?.message||"Failed to resend code. Please try again."}})}goToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||t)(f(A),f(w),f(O),f(P))};static \u0275cmp=b({type:t,selectors:[["app-verify-email"]],decls:16,vars:4,consts:[[1,"verify-container"],[1,"verify-card"],[1,"verify-header"],["class","verify-content",4,"ngIf"],["class","success-content",4,"ngIf"],[1,"verify-footer"],["routerLink","/login",1,"login-link"],["class","error-alert",4,"ngIf"],["class","success-alert",4,"ngIf"],[1,"verify-content"],[1,"instruction"],[1,"verify-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","verificationCode"],["type","text","id","verificationCode","formControlName","verification_code","placeholder","Enter 4-digit code","maxlength","4"],["class","error-message",4,"ngIf"],["type","submit",1,"verify-btn",3,"disabled"],[4,"ngIf"],[1,"resend-section"],[1,"resend-btn",3,"click","disabled"],[1,"error-message"],[1,"success-content"],[1,"success-icon"],[1,"login-btn",3,"click"],[1,"error-alert"],[1,"success-alert"]],template:function(e,c){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4,"\u{1F331} AgriWatch"),n(),i(5,"p"),o(6,"Verify your email address"),n()(),m(7,W,20,11,"div",3)(8,$,9,0,"div",4),i(9,"div",5)(10,"p"),o(11,"Already have an account? "),i(12,"a",6),o(13,"Sign In"),n()()(),m(14,J,2,1,"div",7)(15,K,2,1,"div",8),n()()),e&2&&(a(7),d("ngIf",!c.isVerified),a(),d("ngIf",c.isVerified),a(6),d("ngIf",c.errorMessage),a(),d("ngIf",c.successMessage))},dependencies:[E,M,N,R,I,k,F,L,T,D,S,V],styles:[".verify-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:url(https://images.unsplash.com/photo-1500937386664-56d1dfef3854?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80);background-size:cover;background-position:center;background-attachment:fixed;padding:20px}.verify-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;box-shadow:0 20px 40px #0000001a;padding:40px;width:100%;max-width:450px}.verify-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.verify-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px;font-size:2.5rem}.verify-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin:0}.verify-content[_ngcontent-%COMP%]{margin-bottom:20px}.instruction[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:25px;line-height:1.5}.verify-form[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#2c3e50;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e1e8ed;border-radius:10px;font-size:18px;text-align:center;letter-spacing:4px;transition:border-color .3s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:#e74c3c}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:14px;margin-top:5px}.verify-btn[_ngcontent-%COMP%]{width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s ease}.verify-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px)}.verify-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.resend-section[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid #e1e8ed}.resend-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:10px}.resend-btn[_ngcontent-%COMP%]{background:none;border:2px solid #667eea;color:#667eea;padding:8px 20px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease}.resend-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#667eea;color:#fff}.resend-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.success-content[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.success-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:20px}.success-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#27ae60;margin-bottom:15px}.success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:25px}.login-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#27ae60,#2ecc71);color:#fff;border:none;padding:12px 30px;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s ease}.login-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.verify-footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.login-link[_ngcontent-%COMP%]{color:#667eea;text-decoration:none;font-weight:600}.login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-alert[_ngcontent-%COMP%]{background:#fee;color:#e74c3c;padding:12px;border-radius:8px;margin-top:20px;text-align:center;border:1px solid #fcc}.success-alert[_ngcontent-%COMP%]{background:#efe;color:#27ae60;padding:12px;border-radius:8px;margin-top:20px;text-align:center;border:1px solid #cfc}"]})};export{G as VerifyEmailComponent};
